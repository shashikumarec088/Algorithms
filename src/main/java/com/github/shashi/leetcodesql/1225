# Write your MySQL query statement below


select state as period_state,
min(state_date) as start_date,
max(state_date) as end_date
from
(select state,
state_date,
row_number() over(order by state,state_date) as rn
from
(select 'failed' as state,
fail_date as state_date
from failed
where fail_date between '2019-01-01' and '2019-12-31'
union all
select 'succeeded' as state,
success_date as state_date
from succeeded
where success_date between '2019-01-01' and '2019-12-31')
sub1)
sub2
group by date_sub(state_date,interval rn day),state
order by start_date

/*
select state as period_state,
min(state_date) as start_date,
max(state_date) as end_date
from
(select state,
state_date,
(row_number() over(order by state_date) - rn) as rn1
from
(select 'failed' as state,
fail_date as state_date,
row_number() over(order by fail_date) as rn
from failed
where fail_date between '2019-01-01' and '2019-12-31'
union all
select 'succeeded' as state,
success_date as state_date,
row_number() over(order by success_date) as rn
from succeeded
where success_date between '2019-01-01' and '2019-12-31')
t1) t2
group by rn1,state
*/