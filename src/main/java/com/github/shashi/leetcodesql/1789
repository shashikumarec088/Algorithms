# Write your MySQL query statement below


select employee_id,
case when count(*)=1 then department_id
else max(if(primary_flag='Y',department_id,null)) end as department_id
from employee
group by employee_id
/*
select employee_id,
department_id
from
(select *,
count(employee_id) over(partition by employee_id) as cnt
from employee)
t1
where cnt=1 or primary_flag='Y'
*/
/*
select employee_id,
department_id
from
(
select employee_id,
    department_id,
    row_number() over(partition by employee_id order by primary_flag) as rn
    from employee
)t1
where rn=1
*/

/*
select employee_id,
department_id
from employee e1
where primary_flag='Y'
union
select employee_id,
department_id
from employee e1
group by employee_id
having count(*)=1
*/