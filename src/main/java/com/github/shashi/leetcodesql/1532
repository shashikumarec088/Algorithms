# Write your MySQL query statement below

select name as customer_name,
o1.customer_id,
o1.order_id,
o1.order_date
from orders o1
join customers c1
on o1.customer_id = c1.customer_id
join orders o2
on o1.customer_id = o2.customer_id and
o1.order_date <= o2.order_date
group by name, o1.customer_id,
o1.order_id, o1.order_date
having count(o2.order_date)<=3
order by name, o1.customer_id,
 o1.order_date desc

/*
select customer_name,
customer_id,
order_id,
order_date
from (
select name as customer_name,
    o.order_id,
    o.customer_id,
    order_date,
    row_number() over(partition by customer_id
                     order by order_date desc) as rn
    from orders o
    join customers c
    using(customer_id)
) t1
where rn <4
order by customer_name,
customer_id,
order_date desc
*/