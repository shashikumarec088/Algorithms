# Write your MySQL query statement below
with cte1 as(
select caller_id as user_id, recipient_id, call_time from calls
union all
select recipient_id as user_id, caller_id as recipient_id, call_time from calls
),
cte2 as(
select user_id,recipient_id,
    date(call_time) as day,
    row_number() over (partition by user_id, date(call_time) order by call_time) rf,
    row_number() over (partition by user_id,date(call_time) order by call_time desc) rl
    from cte1
)
select distinct user_id
from cte2
where rf=1 or rl=1
group by user_id, day
having count(distinct recipient_id) = 1
/*select distinct user_id from
(select caller_id as user_id from cte
union all
select recipient_id as user_id from cte)t3
*/