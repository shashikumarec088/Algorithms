# Write your MySQL query statement below

select product_id,
new_price as price
from products
where (product_id,change_date)
in(select product_id,
  max(change_date)
  from products
   where change_date <='2019-08-16'
  group by product_id)
union
select distinct product_id,
10 as price
from products
where product_id not in
(select product_id from products where change_date <='2019-08-16')
/*
select distinct sub1.product_id,
case when sub2.new_price is null then 10 else sub2.new_price end as price
 from products sub1
 left join
(select product_id,
new_price
from products
where (product_id, change_date) in
(select product_id,
max(change_date) as c_date
from products
where change_date <= '2019-08-16'
group by product_id))
sub2
on sub1.product_id = sub2.product_id

*/

/*
select distinct p.product_id,
case when price is null then 10 else sub2.price end as price
from products p
left join
(select product_id,
price
from
(
select product_id,
new_price as price,
row_number() over(partition by product_id order by change_date desc) as rn
from products
where change_date <='2019-08-16'
) sub
where rn=1)
sub2
on p.product_id=sub2.product_id
*/

