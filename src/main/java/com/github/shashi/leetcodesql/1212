# Write your MySQL query statement below


select team_id,
team_name,
sum(case when team_id=host_team and host_goals > guest_goals then 3
    when team_id=guest_team and guest_goals > host_goals then 3
    when guest_goals = host_goals then 1
    else 0 end) as num_points
from teams t
left join matches m
on t.team_id = m.host_team or t.team_id = m.guest_team
group by team_id,team_name
order by num_points desc, team_id


/*

select team_id,
team_name,
sum(if(team_id=host_team,host_score,guest_score)) as num_points
from
(select team_id,
team_name,
match_id,
host_team,
guest_team,
case when host_goals>guest_goals then 3
when host_goals=guest_goals then 1
else 0 end as host_score,
case when guest_goals>host_goals then 3
when host_goals=guest_goals then 1
else 0 end as guest_score
from
teams t
left join matches m
on t.team_id = m.host_team or t.team_id=m.guest_team)
sub
group by team_id, team_name
order by num_points desc,team_id
*/