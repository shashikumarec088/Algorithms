# Write your MySQL query statement below

select team_name,
count(team_id) as matches_played,
sum(
case when team_id=home_team_id and home_team_goals>away_team_goals then 3
    when team_id=home_team_id and home_team_goals<away_team_goals then 0
    when team_id=away_team_id and home_team_goals<away_team_goals then 3
    when team_id=away_team_id and home_team_goals>away_team_goals then 0
    else 1 end
) as points,
sum(
case when team_id=home_team_id then home_team_goals
    else away_team_goals end
) as goal_for,
sum(
case when team_id=home_team_id then away_team_goals
    else home_team_goals end
) as goal_against,
sum(
case when team_id=home_team_id then home_team_goals - away_team_goals
    else away_team_goals - home_team_goals end
) as goal_diff

from matches m
join teams t
on t.team_id in(home_team_id,away_team_id)
group by team_name
order by points desc,
goal_diff desc,
team_name

/*
select team_name,
count(team) as matches_played,
sum(points) as points,
sum(goal_for) as goal_for,
sum(goal_against) as goal_against,
sum(goal_for) - sum(goal_against) as goal_diff
from
(select home_team_id as team,
home_team_goals as goal_for,
away_team_goals as goal_against,
case when home_team_goals > away_team_goals then 3
when home_team_goals = away_team_goals then 1
else 0 end as points
 from matches
union all
select away_team_id as team,
away_team_goals as goal_for,
home_team_goals as goal_against,
case when home_team_goals < away_team_goals then 3
when home_team_goals = away_team_goals then 1
else 0 end as points
from matches)t1
join teams t
on t1.team=t.team_id
group by
team_name
order by points desc,
goal_diff desc,
team_name
*/
