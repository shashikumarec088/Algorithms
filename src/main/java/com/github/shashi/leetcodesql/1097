# Write your MySQL query statement below

select a1.event_date as install_dt,
count(a1.player_id) as installs,
round(sum(case when a1.event_date+1 = a1.next_date
         then 1 else 0 end)/count(player_id),2) as Day1_retention
from
(
select player_id,
event_date,
rank() over(partition by player_id order by event_date) as rn,
lead(event_date,1) over(partition by player_id order by event_date) as next_date
from activity
)
a1
where a1.rn=1
group by a1.event_date
/*
select a3.install_dt,
count(a3.player_id) as installs,
round(count(a3.next_date)/count(player_id),2) as Day1_retention
from
(select a1.player_id,
a1.install_dt,
a2.event_date as next_date
from
(select player_id,
min(event_date) as install_dt
from activity
group by player_id)
a1
left join activity a2
on a1.player_id = a2.player_id
and a1.install_dt+1 = a2.event_date)
a3
group by a3.install_dt
*/



