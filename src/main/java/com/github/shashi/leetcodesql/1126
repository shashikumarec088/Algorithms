# Write your MySQL query statement below


select business_id
from events e
join
(
select event_type,
    avg(occurences) as avg_occ
from events
group by event_type
)
sub
on e.event_type = sub.event_type
and e.occurences > sub.avg_occ
group by business_id
having count(*)>1
/*
select business_id
from
(
select business_id,
occurences,
avg(occurences) over(partition by event_type) as avg_event
from events
)
sub
where occurences > avg_event
group by business_id
having count(*)>1
*/

