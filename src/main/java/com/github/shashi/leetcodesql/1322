# Write your MySQL query statement below

select ad_id,
round(ifnull(avg(case when action='Clicked' then 1
          when action='Viewed' then 0
          else null end)*100,0),2) as ctr
from ads
group by ad_id
order by ctr desc, ad_id

/*
select ad_id,
coalesce(round(sum(if(action='Clicked',1,0))/
     sum(if(action='Clicked' or action='Viewed',1,0))*100,2
     ),0.00) as ctr
from ads
group by ad_id
order by ctr desc,ad_id
*/