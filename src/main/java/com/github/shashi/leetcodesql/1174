# Write your MySQL query statement below


select round(avg(case when order_date = customer_pref_delivery_date
                then 1 else 0 end)*100,2) as immediate_percentage
                from Delivery
                where(customer_id,order_date) in
                (select customer_id,min(order_date) from delivery
                group by customer_id)
/*
select round(100*(select count(*) from (select customer_id from delivery
 group by customer_id
having min(order_date)=min(customer_pref_delivery_date))t1)/
(select count(distinct customer_id) from delivery),2) as immediate_percentage

*/
/*
with cte1 as (
select *,
    row_number() over(partition by customer_id order by order_date) as rn
    from delivery
)
select round(100*(select count(customer_id) from cte1 where rn=1
       and order_date=customer_pref_delivery_date)/
       (select count(customer_id) from cte1 where rn=1),2)
       as immediate_percentage
*/