# Write your MySQL query statement below

select *
from userActivity
group by username
having count(*)=1
union
select u1.username,
u1.activity,
u1.startDate,
u1.endDate
from useractivity u1
left join useractivity u2
on u1.username=u2.username
and u1.endDate<u2.endDate
group by u1.username,u1.endDate
having count(u2.endDate)=1
/*select username,
activity,
startDate,
endDate
from
(select username,
activity,
startDate,
endDate,
row_number() over(partition by username order by endDate desc) as rn,
count(username) over(partition by username) as cn
from userActivity)
sub
where (cn>1 and rn=2) or
(cn=1)
*/