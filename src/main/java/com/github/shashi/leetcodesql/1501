select c.name as country from
country c
join person p on c.country_code = substring(p.phone_number,1,3)
join calls cl
on p.id in (cl.caller_id,cl.callee_id)
group by c.name having avg(duration) > (select avg(duration) from calls)

#select name as country from
#(select name, duration from (select caller_id as c_id, duration from calls
#union select callee_id as c_id, duration from calls) c
#inner join
#(select id, c.name from
#(select id, substring(phone_number,1,3) as c_code from person)
#t1 join country c on c_code = c.country_code) t2
#on c.c_id=t2.id) t3 group by name having avg(duration) > (select avg(duration) as dur from Calls)