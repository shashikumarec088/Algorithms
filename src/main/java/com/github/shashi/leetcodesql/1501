# Write your MySQL query statement below

select distinct country 
from
(select c.name as country,
avg(duration) over(partition by c.name) as avg_co,
avg(duration) over() as avg_total
from calls ca
join person p on
ca.caller_id = p.id or ca.callee_id=p.id
join country c on left(p.phone_number,3)=c.country_code)
t1
where avg_co>avg_total


/*
select co.name as country
from country co
join person p
on left(p.phone_number,3)=co.country_code
join calls c
on p.id in (c.caller_id,c.callee_id)
group by co.name
having
avg(duration) >(select avg(duration) from calls)
*/
/*
with cte as
(select co.name, duration
from calls c
join person p on c.caller_id=p.id
join country co on left(p.phone_number,3)=co.country_code
union all
select co.name, duration
from calls c
join person p on c.callee_id=p.id
join country co on left(p.phone_number,3)=co.country_code)
select name as country from cte
group by name
having avg(duration)>(select avg(duration) from cte)
*/